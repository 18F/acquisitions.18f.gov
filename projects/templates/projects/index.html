{% extends "web/base.html" %}

{% block content %}
  <div class="usa-width-one-full">
    <h1>Projects</h1>
    <h2>Current</h2>
    <!-- TODO: divide projects into phases -->
    <div id="current">

    </div>
  </div>
  <script type="text/javascript">
    function createProject(name, description) {
      // Create a div element with information about the teammate
      let div = document.createElement("div");
      let projectName = document.createElement('h3');
      let nameContent = document.createTextNode(name);
      projectName.appendChild(nameContent);
      projectName.className = 'projectName';
      let projectDescription = document.createElement('div');
      let descriptionContent = document.createTextNode(description);
      projectDescription.appendChild(descriptionContent);
      projectDescription.className = 'projectDescription';
      div.appendChild(projectName);
      div.appendChild(projectDescription);
      return div
    }
    document.addEventListener("DOMContentLoaded", function(event) {
      let current = document.getElementById('current');
      let r = new XMLHttpRequest();
      r.open("GET", "/projects/api/projects", true);
      r.onreadystatechange = function () {
        if (r.readyState != 4 || r.status != 200) return;
        var jsonResponse = JSON.parse(r.responseText);
        if (jsonResponse.length > 0) {
          for (const project of jsonResponse) {
            var grid = document.createElement('div');
            grid.appendChild(createProject(project.name, project.description));
            current.appendChild(grid);
          }
        } else {
          let div = document.createElement("div");
          let content = document.createTextNode("No public projects");
          div.appendChild(content);
          current.appendChild(div);
        }
      };
      r.send();
    });
  </script>
{% endblock %}
